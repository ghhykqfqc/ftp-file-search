# .github/workflows/deploy.yml
name: Daily Scheduled Task (Beijing Time 07:30)

on:
  schedule:
    # 关键：设置为 UTC 时间 23:30，对应北京时间第二天早上 7:30
    - cron: '30 23 * * *'

  # 保留手动触发功能，方便测试和调试
  workflow_dispatch:

jobs:
  run-script:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.12.2'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install requests  # 安装requests库
        # 如果有其他依赖，可以继续添加，例如：
        # pip install ftplib
        # pip install beautifulsoup4

    - name: Execute Python script
      env:
        # 注入所有需要的 Secrets
        FTP_IP: ${{ secrets.FTP_IP }}
        FTP_USERNAME: ${{ secrets.FTP_USERNAME }}
        FTP_PASSWORD: ${{ secrets.FTP_PASSWORD }}
        SEND_KEY: ${{ secrets.SEND_KEY }}
      run: python FtpFileSearch.py # 请务必替换成您的实际脚本文件名
